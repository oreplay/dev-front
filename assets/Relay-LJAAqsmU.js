import{p as y,f as C,l as h,h as R,e as _,k as w,C as T,R as k,a as S,s as I,c as v,S as E}from"./RacePosition.-D-7jvFND.js";import{c as D,j as s,f as d,t as i,T as u,V as F,F as L,q as Q,v as A,r as B}from"./index-VtGzxaYZ.js";import{R as b,V as N,u as O,E as j,a as V,B as p,b as z}from"./RaceTime-B2QoqNH_.js";import{R as M}from"./RaceTimeBehind-NyMTNqJH.js";import{N as g}from"./NotImplementedAlertBox-CG4-37qh.js";import{a as P}from"./hooks-CaBBH4u5.js";import{u as G}from"./useQuery-D3yp_rLX.js";import{a as H}from"./EventService-CIl1W-WG.js";import"./Skeleton-C55ZSa6T.js";import"./Results-BJV7mGVB.js";import"./constants-CeKtPcRb.js";import"./NotFoundPage-Ceu1O5rQ.js";import"./styled-bWhihDx5.js";import"./TextField-CsLSf8b4.js";import"./InputAdornment-BScjRByh.js";import"./index-DN1O8mPu.js";import"./Tabs-BN6Tx5YC.js";import"./KeyboardArrowRight-IaWgI9xr.js";import"./Trans-CRnLzWtc.js";import"./Link-CHOD548i.js";import"./DialogTitle-DwHGm-z-.js";import"./Grid-DvxVs98L.js";import"./Functions-D_F5-m-9.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6955daf6-bc37-47d9-ba6f-1a07f387ab67",e._sentryDebugIdIdentifier="sentry-dbid-6955daf6-bc37-47d9-ba6f-1a07f387ab67")}catch{}const U=D(s("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");function $({legParticipant:e,handleRowClick:t}){const l=y(e.stage.status_code);return d(i,{sx:{display:"table-row",cursor:"pointer","&:hover":{backgroundColor:"#fffbf0"}},onClick:t?()=>t(e):void 0,children:[s(i,{sx:{display:"table-cell",textAlign:"left",padding:"4px 0px"},children:s(u,{sx:{fontSize:"small"},children:`${e.leg_number}.`})}),s(i,{sx:{display:"table-cell",overflow:"hidden",textAlign:"left"},children:s(u,{sx:{fontSize:"small"},children:e.full_name})}),s(i,{sx:{display:"table-cell",textAlign:"right"},children:s(b,{displayStatus:!0,isFinalTime:!0,status:l,finish_time:e.stage.finish_time,time_seconds:e.stage.time_seconds,start_time:e.stage.start_time,style:{fontSize:"small"}})})]})}function q({runner:e,handleRowClick:t}){var o;const l=y(e.stage.status_code),a=l===C.ok||h(e),n=R(e);return d(i,{sx:{display:"table-row",borderBottom:"1px solid #f2f2f2"},onClick:()=>t(e),children:[s(i,{sx:{display:"table-cell",padding:"12px 2px"},children:s(_,{position:e.stage.position,hasDownload:n,isNC:h(e)})}),s(i,{sx:{display:"table-cell",padding:"12px 2px"},children:d(i,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[d(i,{sx:{width:"100%",display:"inline-flex",gap:"5px"},children:[s(i,{sx:{overflow:"hidden",flexGrow:1},children:s(u,{sx:{fontSize:"1em",color:"inherit",overflow:"hidden"},children:e.full_name})}),s(b,{displayStatus:!0,isFinalTime:n,status:l,finish_time:e.stage.finish_time,time_seconds:e.stage.time_seconds,start_time:e.stage.start_time}),s(M,{display:a&&e.stage.finish_time!=null&&n,time_behind:e.stage.time_behind})]}),s(i,{sx:{display:"table"},children:(o=e.runners)==null?void 0:o.map(r=>s($,{legParticipant:r},r.id))})]})})]})}function W({children:e}){return s(i,{sx:{display:"table",width:"100%",borderCollapse:"collapse"},children:s(w,{children:e})})}function X(e){return s(N,{isTicketOpen:e.isTicketOpen,runner:e.runner,handleCloseTicket:e.handleCloseTicket,children:s(g,{})})}function J(e){const t=e.runnersQuery.data,[l,a,n,o]=O();return e.activeItem?e.runnersQuery.isFetching?s(k,{}):e.runnersQuery.isError?s(F,{}):d(L,{children:[s(j,{}),s(W,{children:t==null?void 0:t.map(r=>s(q,{runner:r,handleRowClick:n},r.id))}),s(X,{isTicketOpen:l,runner:a,handleCloseTicket:o,setClassClubId:e.setClassClubId})]}):s(T,{})}function K(e){return s(S,{children:s(g,{})})}async function Y(e,t,l){let n=(await H(e,t,l)).data;return n=I(n),v(n)}const Z=["results","legs"];function we(){const{t:e}=Q(),{eventId:t,stageId:l}=A();if(!t||!l)throw new Error("Event Id or Stage Id is missing");const{activeItem:a,classesQuery:n,clubsQuery:o,isClass:r,setClassClubId:m,refresh:f}=P(),c=G(["results","classes",a==null?void 0:a.id],()=>a?Y(t,l,a.id):Promise.reject(new Error("No active class")),{enabled:!!a&&r,refetchOnWindowFocus:!1}),x=B.useCallback(()=>{f(),c.refetch()},[f,c]);return s(E,{activeItem:a,isClass:r,classesQuery:n,clubsQuery:o,setActiveClassClub:m,handleRefreshClick:x,children:d(V,{defaultMenu:0,menuOptions:[s(p,{label:e("StageHeader.Results"),icon:s(z,{})},"relayResults"),s(p,{label:e("StageHeader.RelayLegs"),icon:s(U,{})},"RogaineScorePointsMenu")],menuOptionsLabels:Z,children:[s(J,{runnersQuery:c,activeItem:a,isClass:r,setClassClubId:m}),s(K,{runnersQuery:c,activeItem:a,isClass:r})]})},"stageLayout")}export{we as default};
//# sourceMappingURL=Relay-LJAAqsmU.js.map
