import{p as y,g as C,n as h,h as R,f as _,l as w,C as T,R as k,a as S,s as I,d as v,S as E}from"./RacePosition.-B6BkPrLD.js";import{c as D,j as s,f as d,t as a,T as u,V as F,F as L,q as Q,v as A,r as B}from"./index-Bq7_3jVk.js";import{R as g,V as N,u as O,E as j,a as V,B as p,b as z}from"./RaceTime-4jHIsuZH.js";import{R as M}from"./RaceTimeBehind-dmTxpr5C.js";import{N as b}from"./NotImplementedAlertBox-C3EP6oLZ.js";import{a as P}from"./hooks-D-R-rDyH.js";import{u as G}from"./useQuery-C7k-JlZw.js";import{a as H}from"./EventService-Qd93CJkn.js";import"./Skeleton-Bp6dYDR5.js";import"./Results-WyzFKdkm.js";import"./constants-BPAhJvPF.js";import"./NotFoundPage-DMYmWl89.js";import"./styled-DO6CDtHy.js";import"./TextField-DbqBfEi2.js";import"./InputAdornment-DHvK-2H8.js";import"./index-BYXtU0FR.js";import"./Tabs-Db4Yz9Cy.js";import"./KeyboardArrowRight-Dc8ymk_B.js";import"./Trans-zb_zPtcA.js";import"./Link-CD6k3L_7.js";import"./DialogTitle-CVjJVph4.js";import"./Grid-DlEM3KUo.js";import"./Functions-DMzCyz_J.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="edd6e150-f374-4165-9168-af39cd391371",e._sentryDebugIdIdentifier="sentry-dbid-edd6e150-f374-4165-9168-af39cd391371")}catch{}const U=D(s("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");function $({legParticipant:e,handleRowClick:t}){const l=y(e.stage.status_code);return d(a,{sx:{display:"table-row",cursor:"pointer","&:hover":{backgroundColor:"#fffbf0"}},onClick:t?()=>t(e):void 0,children:[s(a,{sx:{display:"table-cell",textAlign:"left",padding:"4px 0px"},children:s(u,{sx:{fontSize:"small"},children:`${e.leg_number}.`})}),s(a,{sx:{display:"table-cell",overflow:"hidden",textAlign:"left"},children:s(u,{sx:{fontSize:"small"},children:e.full_name})}),s(a,{sx:{display:"table-cell",textAlign:"right"},children:s(g,{displayStatus:!0,isFinalTime:!0,status:l,finish_time:e.stage.finish_time,time_seconds:e.stage.time_seconds,start_time:e.stage.start_time,style:{fontSize:"small"}})})]})}function q({runner:e,handleRowClick:t}){var o;const l=y(e.stage.status_code),i=l===C.ok||h(e),n=R(e);return d(a,{sx:{display:"table-row",borderBottom:"1px solid #f2f2f2"},onClick:()=>t(e),children:[s(a,{sx:{display:"table-cell",padding:"12px 2px"},children:s(_,{position:e.stage.position,hasDownload:n,isNC:h(e)})}),s(a,{sx:{display:"table-cell",padding:"12px 2px"},children:d(a,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[d(a,{sx:{width:"100%",display:"inline-flex",gap:"5px"},children:[s(a,{sx:{overflow:"hidden",flexGrow:1},children:s(u,{sx:{fontSize:"1em",color:"inherit",overflow:"hidden"},children:e.full_name})}),s(g,{displayStatus:!0,isFinalTime:n,status:l,finish_time:e.stage.finish_time,time_seconds:e.stage.time_seconds,start_time:e.stage.start_time}),s(M,{display:i&&e.stage.finish_time!=null&&n,time_behind:e.stage.time_behind})]}),s(a,{sx:{display:"table"},children:(o=e.runners)==null?void 0:o.map(r=>s($,{legParticipant:r},r.id))})]})})]})}function W({children:e}){return s(a,{sx:{display:"table",width:"100%",borderCollapse:"collapse"},children:s(w,{children:e})})}function X(e){return s(N,{isTicketOpen:e.isTicketOpen,runner:e.runner,handleCloseTicket:e.handleCloseTicket,children:s(b,{})})}function J(e){const t=e.runnersQuery.data,[l,i,n,o]=O();return e.activeItem?e.runnersQuery.isFetching?s(k,{}):e.runnersQuery.isError?s(F,{}):d(L,{children:[s(j,{}),s(W,{children:t==null?void 0:t.map(r=>s(q,{runner:r,handleRowClick:n},r.id))}),s(X,{isTicketOpen:l,runner:i,handleCloseTicket:o,setClassClubId:e.setClassClubId})]}):s(T,{})}function K(e){return s(S,{children:s(b,{})})}async function Y(e,t,l){let n=(await H(e,t,l)).data;return n=I(n),v(n)}const Z=["results","legs"];function we(){const{t:e}=Q(),{eventId:t,stageId:l}=A();if(!t||!l)throw new Error("Event Id or Stage Id is missing");const{activeItem:i,classesQuery:n,clubsQuery:o,isClass:r,setClassClubId:m,refresh:f}=P(),c=G(["results","classes",i==null?void 0:i.id],()=>i?Y(t,l,i.id):Promise.reject(new Error("No active class")),{enabled:!!i&&r,refetchOnWindowFocus:!1}),x=B.useCallback(()=>{f(),c.refetch()},[f,c]);return s(E,{activeItem:i,isClass:r,classesQuery:n,clubsQuery:o,setActiveClassClub:m,handleRefreshClick:x,children:d(V,{defaultMenu:0,menuOptions:[s(p,{label:e("StageHeader.Results"),icon:s(z,{})},"relayResults"),s(p,{label:e("StageHeader.RelayLegs"),icon:s(U,{})},"RogaineScorePointsMenu")],menuOptionsLabels:Z,children:[s(J,{runnersQuery:c,activeItem:i,isClass:r,setClassClubId:m}),s(K,{runnersQuery:c,activeItem:i,isClass:r})]})},"stageLayout")}export{we as default};
//# sourceMappingURL=Relay-DPCsKC-w.js.map
