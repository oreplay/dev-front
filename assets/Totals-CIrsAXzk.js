import{e as S,b as R,C as I,R as _,a as v,s as y,c as b,S as T}from"./RacePosition.-D-7jvFND.js";import{f as l,j as r,T as a,q as D,t as p,V as P,v as Q,r as E}from"./index-VtGzxaYZ.js";import{F as d}from"./FlexCol-Cmk3JnWB.js";import{R as C,P as F}from"./ParticipantName-wAiWAzzh.js";import{a as w}from"./Functions-D_F5-m-9.js";import{N}from"./NotImplementedAlertBox-CG4-37qh.js";import{a as k}from"./hooks-CaBBH4u5.js";import{u as h}from"./useQuery-D3yp_rLX.js";import{a as x}from"./EventService-CIl1W-WG.js";import"./Skeleton-C55ZSa6T.js";import"./Results-BJV7mGVB.js";import"./constants-CeKtPcRb.js";import"./NotFoundPage-Ceu1O5rQ.js";import"./styled-bWhihDx5.js";import"./TextField-CsLSf8b4.js";import"./InputAdornment-BScjRByh.js";import"./index-DN1O8mPu.js";import"./Tabs-BN6Tx5YC.js";import"./KeyboardArrowRight-IaWgI9xr.js";import"./Trans-CRnLzWtc.js";import"./Link-CHOD548i.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="63d8ad4e-39a9-42dd-89c9-dcb170751079",e._sentryDebugIdIdentifier="sentry-dbid-63d8ad4e-39a9-42dd-89c9-dcb170751079")}catch{}function B({stage:e}){const t=e!=null&&e.stage?e.stage.description:`Stage ${e.stage_order}`;return l(C,{children:[r(d,{width:"10px",children:r(a,{sx:{fontSize:"small"},children:`${e.position}.`})}),r(d,{flexGrow:1,children:r(a,{sx:{fontSize:"small"},children:t})}),l(d,{flexGrow:1,children:[r(a,{sx:{fontSize:"small"},children:e.time_seconds?w(e.time_seconds):""}),r(a,{sx:{fontSize:"small"},children:e.points_final})]})]})}function L({runner:e}){var o,i,u;const{t}=D(),s=!0,n=(o=e.overalls)==null?void 0:o.overall;return n?l(p,{sx:{display:"flex",flexDirection:"column"},children:[l(C,{children:[r(d,{width:"10px",children:r(S,{position:n.position,hasDownload:s,isNC:e.is_nc})}),r(F,{name:e.full_name,subtitle:R.getClubName(e,t)}),l(d,{flexGrow:1,children:[r(a,{children:n.time_seconds?w(n.time_seconds):""}),r(a,{children:n.points_final})]})]},e.id),r(p,{sx:{display:"flex",flexDirection:"column"},children:(u=(i=e.overalls)==null?void 0:i.parts)==null?void 0:u.map(c=>r(B,{stage:c},c.id))})]}):(console.error("Totals results without overalls",e),r(p,{}))}function j(e){const t=e.runnersQuery.data,s=n=>{};return e.activeItem?e.runnersQuery.isFetching?r(_,{}):e.runnersQuery.isError?r(P,{}):l(v,{children:[r(N,{}),t==null?void 0:t.map(n=>r(L,{runner:n,handleRowClick:s},n.id))]}):r(I,{})}async function z(e,t,s){let o=(await x(e,t,s)).data;return o=y(o),b(o)}async function G(e,t,s){let o=(await x(e,t,void 0,s)).data;return o=y(o),b(o)}function ae(){const{eventId:e,stageId:t}=Q();if(!e||!t)throw new Error("Event Id or Stage Id is missing");const{activeItem:s,classesQuery:n,clubsQuery:o,isClass:i,setClassClubId:u,refresh:c}=k(),f=h(["results","classes",s==null?void 0:s.id],()=>s?z(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&i,refetchOnWindowFocus:!1}),m=h(["results","clubs",s==null?void 0:s.id],()=>s?G(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&!i,refetchOnWindowFocus:!1}),g=E.useCallback(()=>{c(),f.refetch(),m.refetch()},[c,f,m]);return r(T,{activeItem:s,isClass:i,classesQuery:n,clubsQuery:o,setActiveClassClub:u,handleRefreshClick:g,children:r(j,{runnersQuery:i?f:m,activeItem:s,isClass:i})},"stageLayout")}export{ae as default};
//# sourceMappingURL=Totals-CIrsAXzk.js.map
