import{e as S,b as R,C as I,R as _,a as v,s as y,c as b,S as T}from"./RacePosition.-V_RsdxqH.js";import{f as l,j as r,T as a,q as D,t as p,V as P,v as Q,r as E}from"./index-CviqxJip.js";import{F as d}from"./FlexCol-CmDGbGEu.js";import{R as C,P as F}from"./ParticipantName-Chrb0L-j.js";import{a as w}from"./Functions-UlIk7da8.js";import{N}from"./NotImplementedAlertBox-Dah2I05O.js";import{a as k}from"./hooks-DCC--Gl4.js";import{u as h}from"./useQuery-BH5-If_O.js";import{a as x}from"./EventService-0l16zg9Q.js";import"./Skeleton-CwDSTJ2h.js";import"./Results-DYFU_Mkp.js";import"./constants-BWTqcn5Z.js";import"./NotFoundPage-DsA_hYb3.js";import"./styled-BQbIgZAX.js";import"./TextField-5T4hPdMa.js";import"./InputAdornment-BAZoUICE.js";import"./index-CXQquTea.js";import"./Tabs-BzTVOCYx.js";import"./KeyboardArrowRight-BGdC9kXH.js";import"./Trans-DVn-3tFw.js";import"./Link-CCYYxHxj.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e78adfba-6d09-45a2-a26a-7ecbb965f742",e._sentryDebugIdIdentifier="sentry-dbid-e78adfba-6d09-45a2-a26a-7ecbb965f742")}catch{}function B({stage:e}){const t=e!=null&&e.stage?e.stage.description:`Stage ${e.stage_order}`;return l(C,{children:[r(d,{width:"10px",children:r(a,{sx:{fontSize:"small"},children:`${e.position}.`})}),r(d,{flexGrow:1,children:r(a,{sx:{fontSize:"small"},children:t})}),l(d,{flexGrow:1,children:[r(a,{sx:{fontSize:"small"},children:e.time_seconds?w(e.time_seconds):""}),r(a,{sx:{fontSize:"small"},children:e.points_final})]})]})}function L({runner:e}){var o,i,u;const{t}=D(),s=!0,n=(o=e.overalls)==null?void 0:o.overall;return n?l(p,{sx:{display:"flex",flexDirection:"column"},children:[l(C,{children:[r(d,{width:"10px",children:r(S,{position:n.position,hasDownload:s,isNC:e.is_nc})}),r(F,{name:e.full_name,subtitle:R.getClubName(e,t)}),l(d,{flexGrow:1,children:[r(a,{children:n.time_seconds?w(n.time_seconds):""}),r(a,{children:n.points_final})]})]},e.id),r(p,{sx:{display:"flex",flexDirection:"column"},children:(u=(i=e.overalls)==null?void 0:i.parts)==null?void 0:u.map(c=>r(B,{stage:c},c.id))})]}):(console.error("Totals results without overalls",e),r(p,{}))}function j(e){const t=e.runnersQuery.data,s=n=>{};return e.activeItem?e.runnersQuery.isFetching?r(_,{}):e.runnersQuery.isError?r(P,{}):l(v,{children:[r(N,{}),t==null?void 0:t.map(n=>r(L,{runner:n,handleRowClick:s},n.id))]}):r(I,{})}async function z(e,t,s){let o=(await x(e,t,s)).data;return o=y(o),b(o)}async function G(e,t,s){let o=(await x(e,t,void 0,s)).data;return o=y(o),b(o)}function ae(){const{eventId:e,stageId:t}=Q();if(!e||!t)throw new Error("Event Id or Stage Id is missing");const{activeItem:s,classesQuery:n,clubsQuery:o,isClass:i,setClassClubId:u,refresh:c}=k(),f=h(["results","classes",s==null?void 0:s.id],()=>s?z(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&i,refetchOnWindowFocus:!1}),m=h(["results","clubs",s==null?void 0:s.id],()=>s?G(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&!i,refetchOnWindowFocus:!1}),g=E.useCallback(()=>{c(),f.refetch(),m.refetch()},[c,f,m]);return r(T,{activeItem:s,isClass:i,classesQuery:n,clubsQuery:o,setActiveClassClub:u,handleRefreshClick:g,children:r(j,{runnersQuery:i?f:m,activeItem:s,isClass:i})},"stageLayout")}export{ae as default};
//# sourceMappingURL=Totals-BeBYnAIb.js.map
