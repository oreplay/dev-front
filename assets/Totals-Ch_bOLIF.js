import{f as S,b as R,C as I,R as _,a as v,s as y,d as b,S as T}from"./RacePosition.-B6BkPrLD.js";import{f as l,j as r,T as a,q as D,t as p,V as P,v as Q,r as E}from"./index-Bq7_3jVk.js";import{F as u}from"./FlexCol-nriUBNXZ.js";import{R as C,P as F}from"./ParticipantName-DQWQbvmn.js";import{a as w}from"./Functions-DMzCyz_J.js";import{N}from"./NotImplementedAlertBox-C3EP6oLZ.js";import{a as k}from"./hooks-D-R-rDyH.js";import{u as h}from"./useQuery-C7k-JlZw.js";import{a as x}from"./EventService-Qd93CJkn.js";import"./Skeleton-Bp6dYDR5.js";import"./Results-WyzFKdkm.js";import"./constants-BPAhJvPF.js";import"./NotFoundPage-DMYmWl89.js";import"./styled-DO6CDtHy.js";import"./TextField-DbqBfEi2.js";import"./InputAdornment-DHvK-2H8.js";import"./index-BYXtU0FR.js";import"./Tabs-Db4Yz9Cy.js";import"./KeyboardArrowRight-Dc8ymk_B.js";import"./Trans-zb_zPtcA.js";import"./Link-CD6k3L_7.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c8f8118e-3692-40b1-9978-e08c8fa4a2d0",e._sentryDebugIdIdentifier="sentry-dbid-c8f8118e-3692-40b1-9978-e08c8fa4a2d0")}catch{}function B({stage:e}){const t=e!=null&&e.stage?e.stage.description:`Stage ${e.stage_order}`;return l(C,{children:[r(u,{width:"10px",children:r(a,{sx:{fontSize:"small"},children:`${e.position}.`})}),r(u,{flexGrow:1,children:r(a,{sx:{fontSize:"small"},children:t})}),l(u,{flexGrow:1,children:[r(a,{sx:{fontSize:"small"},children:e.time_seconds?w(e.time_seconds):""}),r(a,{sx:{fontSize:"small"},children:e.points_final})]})]})}function L({runner:e}){var o,i,d;const{t}=D(),s=!0,n=(o=e.overalls)==null?void 0:o.overall;return n?l(p,{sx:{display:"flex",flexDirection:"column"},children:[l(C,{children:[r(u,{width:"10px",children:r(S,{position:n.position,hasDownload:s,isNC:e.is_nc})}),r(F,{name:e.full_name,subtitle:R.getClubName(e,t)}),l(u,{flexGrow:1,children:[r(a,{children:n.time_seconds?w(n.time_seconds):""}),r(a,{children:n.points_final})]})]},e.id),r(p,{sx:{display:"flex",flexDirection:"column"},children:(d=(i=e.overalls)==null?void 0:i.parts)==null?void 0:d.map(c=>r(B,{stage:c},c.id))})]}):(console.error("Totals results without overalls",e),r(p,{}))}function j(e){const t=e.runnersQuery.data,s=n=>{};return e.activeItem?e.runnersQuery.isFetching?r(_,{}):e.runnersQuery.isError?r(P,{}):l(v,{children:[r(N,{}),t==null?void 0:t.map(n=>r(L,{runner:n,handleRowClick:s},n.id))]}):r(I,{})}async function z(e,t,s){let o=(await x(e,t,s)).data;return o=y(o),b(o)}async function G(e,t,s){let o=(await x(e,t,void 0,s)).data;return o=y(o),b(o)}function ae(){const{eventId:e,stageId:t}=Q();if(!e||!t)throw new Error("Event Id or Stage Id is missing");const{activeItem:s,classesQuery:n,clubsQuery:o,isClass:i,setClassClubId:d,refresh:c}=k(),f=h(["results","classes",s==null?void 0:s.id],()=>s?z(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&i,refetchOnWindowFocus:!1}),m=h(["results","clubs",s==null?void 0:s.id],()=>s?G(e,t,s.id):Promise.reject(new Error("No active class")),{enabled:!!s&&!i,refetchOnWindowFocus:!1}),g=E.useCallback(()=>{c(),f.refetch(),m.refetch()},[c,f,m]);return r(T,{activeItem:s,isClass:i,classesQuery:n,clubsQuery:o,setActiveClassClub:d,handleRefreshClick:g,children:r(j,{runnersQuery:i?f:m,activeItem:s,isClass:i})},"stageLayout")}export{ae as default};
//# sourceMappingURL=Totals-Ch_bOLIF.js.map
